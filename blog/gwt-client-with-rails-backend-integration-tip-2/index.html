
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Gwt client with rails backend integration tip - Luc Dewavrin's weblog</title>
  <meta name="author" content="Luc Dewavrin">

  
  <meta name="description" content="Writing a rich web interface in Java and server side code in ruby : pretty unsual isn&#8217;it ? But hey after all, web client interfaces get &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.dewavrin.info/blog/gwt-client-with-rails-backend-integration-tip-2">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="Luc Dewavrin's weblog" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-1239956-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <!--[if lte IE 6]><script src="javascripts/warning.js"></script><script>window.onload=function(){e("/images/custom/ie6/")}</script><![endif]-->
  <header role="banner"><hgroup>
  <h1><a href="/">Luc Dewavrin's weblog</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.dewavrin.info" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Gwt Client With Rails Backend Integration Tip</h1>
    
    
      <p class="meta">
        








  


<time datetime="2006-12-18T00:00:00+01:00" pubdate data-updated="true">Dec 18<span>th</span>, 2006</time>
        
         | <a href="#disqus_thread">Comments</a>
        
      </p>
    
  </header>


<div class="entry-content"><p>
Writing a rich web interface in Java and server side code in ruby : pretty unsual isn&#8217;it ? But hey after all, web client interfaces get everyday more complex and are mix of technologies. Gwt sounds interesting since you write your complex web UI components like you&#8217;d write a Swing widget, mostly in Java. 
Then, unlike echo2  you can compile your Gwt code to Javascript and Html and deploy it in any Web server.So, if you would like to invoke a rails service with a Gwt client and getsa Json response here are the steps to achieve this kind of stuff.
</p>
<p>1) Create a Gwt JSNI class to invoke your rails service.</p>

<p>Update 12/17/06: Since GWT 1.2.2, you can achieve this without writing your own JSNI class, by using the GWT <a href='http://code.google.com/webtoolkit/documentation/com.google.gwt.http.client.RequestBuilder.html'>RequestBuilder</a> class which provides a method to set your own http header.<a href='http://code.google.com/webtoolkit/documentation/com.google.gwt.doc.DeveloperGuide.JavaScriptNativeInterface.html'>Java Script Native Interface</a> is Google Web Toolkit equivalent of JNI but for Javascript. Java objects (which are BTW translated to Javascript code by GWT compiler) can interact with Javascript objects (and reversly).Rails <strong>respond_to</strong> method available in each controller can be used to respond to yourclient and deliver a different response for each mime type asked.Rails uses <strong>Accept HTTP header</strong> to differentiate the asked media type response.So the class <a href='http://www.dewavrin.info/code/HTTPJsonRequest.java'>Java source file (broken link&#8230;)</a> has static GET and POST methods which perform HTTP requests and especially set the accept HTTP header to &#8216;text/json&#8217; . (I grabbed this code from the GWT mailing list and modified it a little bit).Then declare it in your GWT module.</p>
<figure class='code'> <div class='highlight'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='xml'><span class='line'><span class='nt'>&lt;inherits</span> <span class='na'>name=</span><span class='s'>&quot;biz.dewavrin.net.HTTPJsonRequest&quot;</span> <span class='nt'>/&gt;</span>
</span></code></pre></td></tr></table></div></figure>
<p>2) Enable rails to perform Json responses.Everything is explained <a href='http://superfluo.org/blojsom/blog/pic/devel/2006/06/21/How-to-register-a-new-MIME-type-in-Rails.html'>on this blog entry.</a>N.B: importing the json module is &#8220;superfluous&#8221; ;-) since it&#8217;s packed with rails 1.1</p>

<p>3) Modify ROR active record base class to dump themselves as a Json data structure.</p>

<p>Add the following method (the code comes from rails wiki):</p>
<figure class='code'> <div class='highlight'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class='k'>def</span> <span class='nf'>to_json</span><span class='p'>(</span><span class='o'>*</span><span class='p'>)</span>
</span><span class='line'>
</span><span class='line'>  <span class='n'>result</span> <span class='o'>=</span> <span class='no'>Hash</span><span class='o'>.</span><span class='n'>new</span>
</span><span class='line'>  <span class='nb'>self</span><span class='o'>.</span><span class='n'>class</span><span class='o'>.</span><span class='n'>content_columns</span><span class='o'>.</span><span class='n'>each</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>column</span><span class='o'>|</span>
</span><span class='line'>    <span class='n'>result</span><span class='o'>[</span><span class='n'>column</span><span class='o'>.</span><span class='n'>name</span><span class='o'>.</span><span class='n'>to_sym</span><span class='o'>]</span> <span class='o'>=</span> <span class='nb'>self</span><span class='o'>.</span><span class='n'>send</span><span class='p'>(</span><span class='n'>column</span><span class='o'>.</span><span class='n'>name</span><span class='p'>)</span>
</span><span class='line'>  <span class='k'>end</span>
</span><span class='line'>  <span class='n'>result</span><span class='o'>.</span><span class='n'>to_json</span>
</span><span class='line'>
</span><span class='line'><span class='k'>end</span>
</span></code></pre></td></tr></table></div></figure>
<p>4) In your rails controller, send a Json response when asked (note the call to the to_json method):</p>
<figure class='code'> <div class='highlight'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class='k'>def</span> <span class='nf'>list</span>
</span><span class='line'>  <span class='vi'>@songs</span> <span class='o'>=</span> <span class='no'>Song</span><span class='o'>.</span><span class='n'>find</span><span class='p'>(</span><span class='ss'>:all</span><span class='p'>)</span>
</span><span class='line'>  <span class='n'>respond_to</span> <span class='k'>do</span> <span class='o'>|</span><span class='n'>wants</span><span class='o'>|</span>
</span><span class='line'>    <span class='n'>wants</span><span class='o'>.</span><span class='n'>json</span> <span class='p'>{</span>
</span><span class='line'>       <span class='n'>render</span> <span class='ss'>:text</span> <span class='o'>=&gt;</span> <span class='vi'>@songs</span><span class='o'>.</span><span class='n'>to_json</span>
</span><span class='line'>    <span class='p'>}</span>
</span><span class='line'>    <span class='n'>wants</span><span class='o'>.</span><span class='n'>html</span> <span class='p'>{</span>
</span><span class='line'>        <span class='vi'>@song_pages</span><span class='p'>,</span> <span class='vi'>@songs</span> <span class='o'>=</span> <span class='n'>paginate</span> <span class='ss'>:song</span><span class='p'>,</span> <span class='ss'>:per_page</span> <span class='o'>=&amp;</span><span class='n'>gt</span><span class='p'>;</span> <span class='mi'>10</span>
</span><span class='line'>    <span class='p'>}</span>
</span><span class='line'>  <span class='k'>end</span>
</span><span class='line'><span class='k'>end</span>
</span></code></pre></td></tr></table></div></figure>
<p>and in your GWT client, the asynchronous HTTP request-response:</p>
<figure class='code'> <div class='highlight'><table><tr><td class='gutter'><pre class='line-numbers'><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='java'><span class='line'> <span class='n'>HTTPJsonRequest</span><span class='o'>.</span><span class='na'>asyncGet</span><span class='o'>(</span><span class='s'>&quot;http://localhost:3000/library/list&quot;</span><span class='o'>,</span> <span class='k'>new</span> <span class='n'>ResponseTextHandler</span><span class='o'>()</span> <span class='o'>{</span>
</span><span class='line'>        <span class='k'>try</span> <span class='o'>{</span> <span class='n'>JSONValue</span> <span class='n'>jsonValue</span> <span class='o'>=</span> <span class='n'>JSONParser</span><span class='o'>.</span><span class='na'>parse</span><span class='o'>(</span><span class='n'>responseText</span><span class='o'>);</span> <span class='o'>...</span> <span class='o'>}</span>
</span><span class='line'>        <span class='k'>catch</span> <span class='o'>(</span><span class='n'>JSONException</span> <span class='n'>e</span><span class='o'>)</span> <span class='o'>{</span> <span class='c1'>// do nothing } </span>
</span><span class='line'> <span class='o'>}</span> <span class='o'>);</span>
</span></code></pre></td></tr></table></div></figure>
<p>Note that this solution is limited for the following reasons:</p>

<ul>
<li>It&#8217;s forbidden to do Java reflection in the GWT client. So you can&#8217;tinstantiate a JavaBean from a Json object in a generic way.I would have liked to add a type field in my Json data representationand have my Java code instantiate a bean.</li>

<li>Gwt client limits usage of J2SE 1.4.2 to collection&#8217;s API and some java.lang classes. See <a href='http://code.google.com/webtoolkit/documentation/com.google.gwt.doc.DeveloperGuide.Fundamentals.JavaToJavaScriptCompiler.JavaRuntimeSupport.html'>runtime library support</a></li>
</ul></div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Luc Dewavrin</span></span>

      








  


<time datetime="2006-12-18T00:00:00+01:00" pubdate data-updated="true">Dec 18<span>th</span>, 2006</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/java/'>java</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://www.dewavrin.info/blog/gwt-client-with-rails-backend-integration-tip-2/" data-via="lucdew" data-counturl="http://www.dewavrin.info/blog/gwt-client-with-rails-backend-integration-tip-2/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/maven-quick-tip-adding-a-local-dependency/" title="Previous Post: Maven quick tip: adding a local dependency">&laquo; Maven quick tip: adding a local dependency</a>
      
      
        <a class="basic-alignment right" href="/blog/what-i-learnt-today-or-my-ignorance-revealed-to-the-world/" title="next Post: What i learnt today or my ignorance revealed to the world">What i learnt today or my ignorance revealed to the world &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/svnsync-to-existing-repository/">svnsync to existing repository</a>
      </li>
    
      <li class="post">
        <a href="/blog/last-post/">Last Post</a>
      </li>
    
      <li class="post">
        <a href="/blog/osgi-survey/">OSGI survey</a>
      </li>
    
      <li class="post">
        <a href="/blog/mimic-facelet-layouts-in-grails/">Mimic facelet layouts in grails</a>
      </li>
    
      <li class="post">
        <a href="/blog/acquisition-de-sun-par-oracle/">Acquisition de Sun par Oracle</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("lucdew", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/lucdew" class="twitter-follow-button" data-show-count="false">Follow @lucdew</a>
  
</section>




<section><h1>Tags</h1><p><a href="/tags/ant" title="Postings tagged ant" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">ant</a> <a href="/tags/aop" title="Postings tagged aop" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">aop</a> <a href="/tags/aspectj" title="Postings tagged aspectj" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">aspectj</a> <a href="/tags/asterisk" title="Postings tagged asterisk" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">asterisk</a> <a href="/tags/axis" title="Postings tagged axis" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">axis</a> <a href="/tags/blog" title="Postings tagged blog" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">blog</a> <a href="/tags/eclipse" title="Postings tagged eclipse" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">eclipse</a> <a href="/tags/ejb" title="Postings tagged ejb" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">ejb</a> <a href="/tags/firewall" title="Postings tagged firewall" style="font-size: 12.5px; line-height:12.5px;text-decoration:none;">firewall</a> <a href="/tags/freebsd" title="Postings tagged freebsd" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">freebsd</a> <a href="/tags/grails" title="Postings tagged grails" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">grails</a> <a href="/tags/groovy" title="Postings tagged groovy" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">groovy</a> <a href="/tags/gwt" title="Postings tagged gwt" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">gwt</a> <a href="/tags/htmlunit" title="Postings tagged htmlunit" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">htmlunit</a> <a href="/tags/jBPM" title="Postings tagged jBPM" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">jBPM</a> <a href="/tags/java" title="Postings tagged java" style="font-size: 12.5px; line-height:12.5px;text-decoration:none;">java</a> <a href="/tags/jaxb" title="Postings tagged jaxb" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jaxb</a> <a href="/tags/jdbc" title="Postings tagged jdbc" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">jdbc</a> <a href="/tags/jibx" title="Postings tagged jibx" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jibx</a> <a href="/tags/jms" title="Postings tagged jms" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jms</a> <a href="/tags/jmx" title="Postings tagged jmx" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jmx</a> <a href="/tags/jpa" title="Postings tagged jpa" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jpa</a> <a href="/tags/jrockit" title="Postings tagged jrockit" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jrockit</a> <a href="/tags/jsf" title="Postings tagged jsf" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jsf</a> <a href="/tags/jta" title="Postings tagged jta" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">jta</a> <a href="/tags/ldap" title="Postings tagged ldap" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">ldap</a> <a href="/tags/lingo" title="Postings tagged lingo" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">lingo</a> <a href="/tags/maven" title="Postings tagged maven" style="font-size: 13.0px; line-height:13.0px;text-decoration:none;">maven</a> <a href="/tags/misc" title="Postings tagged misc" style="font-size: 13.0px; line-height:13.0px;text-decoration:none;">misc</a> <a href="/tags/osgi" title="Postings tagged osgi" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">osgi</a> <a href="/tags/quartz" title="Postings tagged quartz" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">quartz</a> <a href="/tags/rails" title="Postings tagged rails" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">rails</a> <a href="/tags/ruby" title="Postings tagged ruby" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">ruby</a> <a href="/tags/seam" title="Postings tagged seam" style="font-size: 12.0px; line-height:12.0px;text-decoration:none;">seam</a> <a href="/tags/security" title="Postings tagged security" style="font-size: 12.0px; line-height:12.0px;text-decoration:none;">security</a> <a href="/tags/snmp" title="Postings tagged snmp" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">snmp</a> <a href="/tags/spring" title="Postings tagged spring" style="font-size: 16.0px; line-height:16.0px;text-decoration:none;">spring</a> <a href="/tags/subversion" title="Postings tagged subversion" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">subversion</a> <a href="/tags/svn" title="Postings tagged svn" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">svn</a> <a href="/tags/swing" title="Postings tagged swing" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">swing</a> <a href="/tags/tomcat" title="Postings tagged tomcat" style="font-size: 11.0px; line-height:11.0px;text-decoration:none;">tomcat</a> <a href="/tags/tuning" title="Postings tagged tuning" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">tuning</a> <a href="/tags/voip" title="Postings tagged voip" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">voip</a> <a href="/tags/vpn" title="Postings tagged vpn" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">vpn</a> <a href="/tags/web2.0-ria" title="Postings tagged web2.0-ria" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">web2.0-ria</a> <a href="/tags/weblogic" title="Postings tagged weblogic" style="font-size: 20.0px; line-height:20.0px;text-decoration:none;">weblogic</a> <a href="/tags/webservices" title="Postings tagged webservices" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">webservices</a> <a href="/tags/websphere" title="Postings tagged websphere" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">websphere</a> <a href="/tags/xfire" title="Postings tagged xfire" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">xfire</a> <a href="/tags/xpath" title="Postings tagged xpath" style="font-size: 10.5px; line-height:10.5px;text-decoration:none;">xpath</a> </p></section>
<section>
  <h1>Visitors</h1>
  <p><a href="http://www2.clustrmaps.com/counter/maps.php?url=http://www.dewavrin.info" id="clustrMapsLink"><img src="http://www2.clustrmaps.com/counter/index2.php?url=http://www.dewavrin.info" style="text-decoration: none; margin-bottom: 1em; border:1px solid;" onmouseover="this.style.textDecoration = 'none'" alt="Locations of visitors to this page" title="Locations of visitors to this page" id="clustrMapsImg" onError="this.onError=null; this.src='http://clustrmaps.com/images/clustrmaps-back-soon.jpg'; document.getElementById('clustrMapsLink').href='http://clustrmaps.com'" /> </a>
</p>
</section>

  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Luc Dewavrin -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'lucdewavrinsblog';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://www.dewavrin.info/blog/gwt-client-with-rails-backend-integration-tip-2/';
        var disqus_url = 'http://www.dewavrin.info/blog/gwt-client-with-rails-backend-integration-tip-2/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
